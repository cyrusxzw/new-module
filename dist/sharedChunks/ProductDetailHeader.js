"use strict";var e=require("react"),t=require("classnames");require("./AddToCartContext.js"),require("./GoogleMapsContext.js"),require("./ErrorContext.js"),require("./LoadMoreContext.js"),require("./NavBarThemeContext.js"),require("./NotificationContext.js");var a=require("./ProductDetailContext.js"),l=require("./ThemeContext.js"),i=require("./VariantSelectContext.js"),r=require("./Breadcrumbs.js"),s=require("./Hidden.js"),n=require("./tslib.es6.js"),u=require("./useWindowHasResized.js");require("./viewports.js");var d=require("./useExecuteOnImpression.js");require("./environment.js");var c=require("./product.js"),o=require("./viewport.js"),m=require("./AddToCartButton.js"),f=require("./Button.js"),p=require("./DefinitionList.js"),E=require("./FlyinPanel.js"),y=require("./Heading.js"),v=require("./Icon.js"),h=require("./Paragraph.js"),g=require("./ProductExtract.js"),C=require("./RadioGroup.js"),N=require("./Transition.js"),q=require("./ProductDetailHeader.module.js"),x=require("./useImageTransition.js");require("./isSymbol.js");var T=require("./Figure.js"),j=require("./Image.js");function D(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var P=D(e),b=D(t),w=function(t){var r,x,T,j=t.className,D=t.copy,w=t.theme,H=t.onFlyinOpenCloseClick,k=t.onUpsellScrollIntoView,S=t.onUpsellClick,I=t.paymentWidget,V=l.useThemeContext(w,"dark"),A=e.useState(!1),L=A[0],O=A[1],B=e.useRef(null),R=a.useProductDetailContext().productDetail;d.useExecuteOnImpression(B,(function(){k&&k()}),{threshold:.2,isExecutableOnReEntry:!1});var z=i.useVariantSelectContext(),F=z.selectedVariant,$=z.onVariantChange,M=z.variants;if(u.useWindowHasResized(),!R)return null;var U=R.definitionList,_=R.flyinPanel,W=R.productName,G=R.description,X=R.upSellProduct,J=c.getVariantRadioOptions(M),K=function(){H("open"),O(!0)},Q=b.default(q.styles.base,q.styles[V],j),Y=q.styles.flyinPanelTrigger,Z=b.default(q.styles.paymentWidget,((r={})[q.styles.hasBottomBorder]=!!X&&o.isViewport("lg")||!!(null==F?void 0:F.cartDisclaimer)&&o.isViewport("xs to sm only"),r),j),ee=U.map((function(e){var t=e.isExpandable,a=n.__rest(e,["isExpandable"]);return t?function(e){return{term:P.default.createElement(P.default.Fragment,null,P.default.createElement("span",null,e.term),_&&P.default.createElement(f.Button,{className:Y,isInline:!0,onClick:K,theme:V,title:e.term},P.default.createElement(v.Icon,{height:22,isActive:L,name:"plusAndCloseWithCircle",theme:V,width:22}))),description:e.description,id:e.id}}(a):a})),te=M.length>1?null===(x=null==D?void 0:D.size)||void 0===x?void 0:x.plural:null===(T=null==D?void 0:D.size)||void 0===T?void 0:T.singular,ae=!!J.length&&o.isViewport("lg")||!(!o.isViewport("xs to md only")||!X);return P.default.createElement("div",{className:Q},P.default.createElement("div",{className:q.styles.content},P.default.createElement(s.Hidden,{when:["md"]},P.default.createElement("header",{className:q.styles.header},P.default.createElement(N.Transition,{isActiveOnMount:!0,type:"fade"},P.default.createElement(y.Heading,{className:q.styles.productName,isFlush:!0,level:"1",size:"xLarge",theme:V},W)))),!!G&&P.default.createElement(s.Hidden,{when:["md"]},P.default.createElement("div",{className:q.styles.description},P.default.createElement(N.Transition,{isActiveOnMount:!0,type:"fade"},P.default.createElement(h.Paragraph,{className:q.styles.descriptionCopy,isFlush:!0,theme:V},G)))),P.default.createElement("div",{className:q.styles.purchase},!!J.length&&P.default.createElement(N.Transition,{isActiveOnMount:!0,type:"shiftInDown"},P.default.createElement(y.Heading,{hasMediumWeightFont:!0,isFlush:!0,level:"4",size:"xXSmall",theme:V},te)),P.default.createElement(N.Transition,{isActiveOnMount:!0,type:"shiftInDown"},P.default.createElement(C.RadioGroup,{className:q.styles.variants,dataTestRef:"PRODUCT_DETAIL_VARIANT_SELECT",name:"sku",onChange:function(e){return $(e,M)},options:J,theme:V,value:null==F?void 0:F.sku})),P.default.createElement(m.AddToCartButton,{copy:null==D?void 0:D.addToCart,dataTestRef:"ADD_TO_CART",theme:V}),I&&P.default.createElement("div",{className:Z},I)),P.default.createElement(s.Hidden,{when:["md","lg","xl"]},!!(null==F?void 0:F.cartDisclaimer)&&P.default.createElement("div",{className:q.styles.cartDisclaimer},P.default.createElement("span",null,F.cartDisclaimer))),P.default.createElement("div",{className:q.styles.details},P.default.createElement(N.Transition,{isActiveOnMount:!0,type:"shiftInDown"},P.default.createElement(p.DefinitionList,{className:q.styles.definitionList,hasBottomBorder:ae,items:ee,theme:V}))),!!X&&P.default.createElement("div",{className:q.styles.upSell,ref:B},P.default.createElement(g.ProductExtract,{dataTestRef:"PRODUCT_UP_SELL",hasBottomBorder:!1,hasTopMargin:!1,imageSize:"medium",itemNum:1,onHyperlinkClick:S,product:X,theme:V,works:D.upSellProductLabel}))),P.default.createElement(s.Hidden,{when:["sm","lg","xl"]},P.default.createElement("div",{className:q.styles.mediumSidebar},P.default.createElement("header",null,P.default.createElement(y.Heading,{className:q.styles.mediumProductName,level:"1",size:"xLarge",theme:V},W),P.default.createElement(h.Paragraph,{className:q.styles.mediumDescriptionCopy,theme:V},G),!!(null==F?void 0:F.cartDisclaimer)&&P.default.createElement("div",{className:q.styles.cartDisclaimer},P.default.createElement("span",null,F.cartDisclaimer))))),!!_&&P.default.createElement(E.FlyinPanel,{heading:D.flyinPanelHeading,isVisible:L,onClose:function(){H("close"),O(!1)}},_))},H=function(t){var a=t.className,r=t.theme,n=e.useRef(),u=l.useThemeContext(r,"dark"),d=i.useVariantSelectContext().selectedVariant,c=(d||{}).cartDisclaimer,o=x.useImageTransition(null==d?void 0:d.image,n,600,{cartDisclaimer:c}),m=o[0],f=o[1];if(!(null==d?void 0:d.image))return null;var p=b.default(q.styles$1.base,q.styles$1[u],a),E=m.altText,y=m.sizes,v=m.cartDisclaimer;return P.default.createElement(N.Transition,{isActiveOnMount:!0,type:"shiftInLeft"},P.default.createElement("div",{className:p},P.default.createElement(N.Transition,{isActive:f,type:"fade"},P.default.createElement(T.Figure,null,P.default.createElement(j.Image,{altText:E,className:q.styles$1.image,ref:n,sizes:y}),v&&P.default.createElement(s.Hidden,{when:["sm","md"]},P.default.createElement("div",{className:q.styles$1.cartDisclaimer},P.default.createElement("span",null,v)))))))};exports.ProductDetailHeader=function(e){var t,n=e.breadcrumbs,u=e.className,d=e.copy,c=e.onBreadcrumbClick,o=e.onFlyinOpenCloseClick,m=e.onUpsellScrollIntoView,f=e.onUpsellClick,p=e.paymentWidget,E=e.theme,y=l.useThemeContext(E,"dark"),v=a.useProductDetailContext().productDetail,h=i.useVariantSelectContext().selectedVariant,g=b.default(q.styles$2.base,u),C=b.default(q.styles$2.image,((t={})[q.styles$2.largeImage]="Large"===v.imageSize,t)),N=function(e){return c(e,h)};return P.default.createElement("div",{className:g},P.default.createElement("div",{className:q.styles$2.wrapper},P.default.createElement("div",{className:q.styles$2.content,"data-testid":"data-testid-ProductDetailHeader-content"},P.default.createElement(s.Hidden,{when:["sm"]},P.default.createElement(r.Breadcrumbs,{className:q.styles$2.breadcrumbs,items:n.items,onHyperlinkClick:N,theme:y})),P.default.createElement(w,{copy:{addToCart:null==d?void 0:d.addToCart,size:null==d?void 0:d.size,upSellProductLabel:null==d?void 0:d.upSellProductLabel,flyinPanelHeading:null==d?void 0:d.flyinPanelHeading},onFlyinOpenCloseClick:function(e){return o(e,h)},onUpsellClick:f,onUpsellScrollIntoView:function(){return m&&m()},paymentWidget:p,theme:y})),P.default.createElement("div",{className:C,"data-testid":"data-testid-ProductDetailHeader-image"},P.default.createElement(s.Hidden,{when:["md","lg","xl"]},P.default.createElement(r.Breadcrumbs,{className:q.styles$2.breadcrumbs,items:n.items,onHyperlinkClick:N,theme:y})),P.default.createElement(H,{theme:y}))))};

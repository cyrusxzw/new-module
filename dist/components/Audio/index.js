"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("classnames"),t=require("../../sharedChunks/Loading.js"),n=require("../../sharedChunks/Audio.module.js"),a=require("../../sharedChunks/debounce.js"),u=require("../../sharedChunks/isSymbol.js");function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("../../sharedChunks/viewports.js"),require("../../sharedChunks/AddToCartContext.js"),require("../../sharedChunks/GoogleMapsContext.js"),require("../../sharedChunks/tslib.es6.js"),require("../../sharedChunks/ErrorContext.js"),require("../../sharedChunks/LoadMoreContext.js"),require("../../sharedChunks/NavBarThemeContext.js"),require("../../sharedChunks/NotificationContext.js"),require("../../sharedChunks/ProductDetailContext.js"),require("../../sharedChunks/ThemeContext.js"),require("../../sharedChunks/VariantSelectContext.js"),require("../../sharedChunks/find.js"),require("../../sharedChunks/get.js"),require("../../sharedChunks/toNumber.js"),require("query-string"),require("../../sharedChunks/style-inject.es.js"),require("../../sharedChunks/Heading.js"),require("moment"),require("../../sharedChunks/Hyperlink.js"),require("../../sharedChunks/Icon.js"),require("react-uid"),require("../../sharedChunks/Button.js");var o=s(e),l=s(r),d=Object.freeze({__proto__:null,GREY_60:"#b3ada5",HIGHLIGHT_GREEN:"#007544",HIGHLIGHT_BLUE:"#114094",HIGHLIGHT_ORANGE:"#c67330"});var c=function(e,r,t){var n=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return u.isObject_1(t)&&(n="leading"in t?!!t.leading:n,s="trailing"in t?!!t.trailing:s),a.debounce_1(e,r,{leading:n,maxWait:r,trailing:s})},f=function(e,r){return"green"===e?r.HIGHLIGHT_GREEN:"blue"===e?r.HIGHLIGHT_BLUE:r.HIGHLIGHT_ORANGE},h=function(r,t){var n=e.useRef(null),a=e.useRef(null),u=e.useRef(null),s=e.useState(0),o=s[0],l=s[1],h=e.useState(!0),k=h[0],g=h[1],C=e.useState(!1),j=C[0],p=C[1],v=e.useState(0),m=v[0],q=v[1],y=function(){p((function(e){return!e})),a.current.playPause()};return e.useEffect((function(){Promise.resolve().then((function(){return i(require("wavesurfer.js"))})).then((function(e){var s=e.default||e;if(n.current){a.current=s.create({backend:"MediaElement",barGap:2,barWidth:1,container:n.current,cursorColor:"transparent",cursorWidth:1,height:80,progressColor:f(r,d),responsive:!0,skipLength:30,waveColor:"#b3ada5"}),a.current.load(u.current);var i=c((function(e){q(e)}),1e3);return a.current.on("audioprocess",i),a.current.on("waveform-ready",(function(){g(!1),l(a.current.getDuration()),t&&y()})),function(){a.current.unAll(),a.current.destroy()}}}))}),[r,t]),{duration:o,isLoading:k,isPlaying:j,progress:m,togglePlaying:y,trackRef:u,waveformRef:n,wavesurfer:a}};exports.Audio=function(e){var r,a=e.artistName,u=e.audioUrl,s=e.className,i=e.copy,d=e.hasAutoPlay,c=void 0!==d&&d,f=e.id,k=e.progressColor,g=void 0===k?"orange":k,C=e.trackTitle,j=h(g,c),p=j.duration,v=j.isLoading,m=j.isPlaying,q=j.progress,y=j.togglePlaying,b=j.trackRef,w=j.waveformRef,E=j.wavesurfer,H=l.default(n.styles.base,((r={})[n.styles.disabled]=v,r),s);return o.default.createElement("article",{className:H,id:f},o.default.createElement(n.AudioHeader,{artistName:a,trackTitle:C}),o.default.createElement("div",{className:n.styles.waveContainer},o.default.createElement(t.Loading,{className:n.styles.loading,isLoading:v}),o.default.createElement("figure",{className:n.styles.waveform,ref:w}),o.default.createElement("audio",{ref:b,src:u})),o.default.createElement(n.AudioFooter,{audioUrl:u,copy:{downloadLabel:null==i?void 0:i.downloadLabel,downloadTitle:null==i?void 0:i.downloadTitle,loading:null==i?void 0:i.loading,pause:null==i?void 0:i.pause,play:null==i?void 0:i.play,seekBackward:null==i?void 0:i.seekBackward,seekForward:null==i?void 0:i.seekForward},duration:p,isLoading:v,isPlaying:m,onPlayPauseButtonClick:function(){y()},onSeekBackwardButtonClick:function(){E.current.skipBackward()},onSeekForwardButtonClick:function(){E.current.skipForward()},progress:q,progressColor:g}))};
